(this["webpackJsonptapis-swr"]=this["webpackJsonptapis-swr"]||[]).push([[0],{334:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),i=n(52),a=n.n(i),s=(n(59),n(43)),o=n(38),u=n(26),l=n(53),j=(n(60),n(337)),d=n(41),h=n(13),b=n(31),p=n(37),O=n(336),f=n(338),x=n(47),v=n.n(x),g=n(19),m=n.n(g),w=n(30),k=n(39),P=n(25),y=n.n(P);function S(e){return C.apply(this,arguments)}function C(){return(C=Object(w.a)(m.a.mark((function e(t){var n,r,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new k.Files.Configuration({basePath:"https://tacc.tapis.io",headers:{"x-tapis-token":y.a.get("swr-token")||""}}),r=new k.Files.FileOperationsApi(n),e.next=4,r.listFiles(t);case 4:return c=e.sent,e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e){return q.apply(this,arguments)}function q(){return(q=Object(w.a)(m.a.mark((function e(t){var n,r,c,i,a,s,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.username,c=t.password,i={reqCreateToken:{grant_type:"password",username:r,password:c}},a=new k.Authenticator.Configuration({basePath:"https://tacc.tapis.io"}),s=new k.Authenticator.TokensApi(a),e.next=6,s.createToken(i);case 6:if(o=e.sent,null===(n=o.result)||void 0===n?void 0:n.access_token){e.next=9;break}throw new Error("Could not parse access token from response.");case 9:return e.abrupt("return",o.result.access_token);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var E=n(339),I=function(){var e=Object(h.g)(),t=(Object(h.h)().state||{from:{pathname:"/"}}).from,n=Object(O.a)("authcookie",(function(){return y.a.get("swr-token")}),{initialData:y.a.get("swr-token")}),r=n.data,c=n.error,i=n.refetch,a=Object(E.a)(F,{onSuccess:function(){var n=Object(w.a)(m.a.mark((function n(r){var c,a,s;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=new Date(null!==(c=r.expires_at)&&void 0!==c?c:0),y.a.set("swr-token",null!==(a=r.access_token)&&void 0!==a?a:"",{expires:s}),n.next=4,i();case 4:e.replace(t);case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}),s=a.mutate;return{data:r,error:c,loginStatus:a.status,loginError:a.error,login:s,logout:function(){var t=Object(w.a)(m.a.mark((function t(){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return y.a.remove("swr-token"),t.next=3,i();case 3:e.push("/");case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},L=n(3),T=["children"],N=new j.a;function _(){var e=I(),t=e.data,n=e.error,r=e.logout;return t&&!n?Object(L.jsxs)("p",{children:["Welcome!",Object(L.jsx)("button",{onClick:function(){r()},children:"Sign out"})]}):Object(L.jsx)("p",{children:"You are not logged in."})}function A(e){var t=e.children,n=Object(l.a)(e,T),r=I().data;return Object(L.jsx)(h.b,Object(u.a)(Object(u.a)({},n),{},{render:function(e){var n=e.location;return r?t:Object(L.jsx)(h.a,{to:{pathname:"/login",state:{from:n}}})}}))}function D(){var e=(Object(h.h)().state||{from:{pathname:"/"}}).from,t=I(),n=t.login,c=t.loginStatus,i=t.loginError,a=Object(r.useState)(""),s=Object(o.a)(a,2),u=s[0],l=s[1],j=Object(r.useState)(""),d=Object(o.a)(j,2),b=d[0],p=d[1];return Object(L.jsxs)("div",{children:[i&&Object(L.jsx)("p",{children:"Error! Try logging in again! "}),Object(L.jsxs)("p",{children:["You must log in to view the page at ",e.pathname]}),"Username:",Object(L.jsx)("input",{value:u,onChange:function(e){return l(e.target.value)}}),Object(L.jsxs)("form",{onSubmit:function(e){e.preventDefault(),n({username:u,password:b})},children:["Password:",Object(L.jsx)("input",{type:"password",value:b,onChange:function(e){return p(e.target.value)}})]}),Object(L.jsxs)("button",{onClick:function(){return n({username:u,password:b})},children:["Log in (mutate) ",c]})]})}function J(){return Object(L.jsx)("h3",{children:"Public page"})}function W(){var e,t,n=(t={systemId:"tapisv3-storage",path:""},Object(O.a)([t],(function(){return S(t)}))),r=n.data,c=n.error,i=n.isLoading,a=n.isFetching;return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)("h3",{children:"Protected(swr)"}),a&&Object(L.jsx)("div",{children:"is fetching..."}),c&&Object(L.jsx)("div",{children:"error!"}),i&&Object(L.jsx)("div",{children:"loading..."}),Object(L.jsx)("ul",{children:null===r||void 0===r||null===(e=r.result)||void 0===e?void 0:e.map((function(e){return Object(L.jsx)("li",{children:e.name},e.name)}))})]})}function z(){var e,t,n,r=function(e){var t,n=null!==(t=e.limit)&&void 0!==t?t:100;return Object(f.a)([e],(function(t){var n=t.pageParam;return S(void 0===n?e:n)}),{getNextPageParam:function(t,r){var c,i;if(!((null!==(c=null===(i=t.result)||void 0===i?void 0:i.length)&&void 0!==c?c:0)<n))return Object(u.a)(Object(u.a)({},e),{},{offset:r.length*n})}})}({systemId:"tapisv3-storage",path:"",limit:10}),c=r.data,i=r.isLoading,a=r.fetchNextPage,o=r.hasNextPage,l=null!==(e=null===c||void 0===c||null===(t=c.pages)||void 0===t?void 0:t.map((function(e){var t;return null!==(t=e.result)&&void 0!==t?t:[]})))&&void 0!==e?e:[],j=(n=[]).concat.apply(n,Object(s.a)(l));return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)("h3",{children:"Protected(swr)"}),i&&Object(L.jsx)("div",{children:"loading..."}),Object(L.jsx)("ul",{children:j.map((function(e){return Object(L.jsx)("li",{children:e.name},e.name)}))}),Object(L.jsx)("button",{onClick:function(){a()},children:o?"fetch next":"no more to fetch"})]})}function B(){var e,t,n,r=(n={systemId:"tapisv3-storage",path:""},Object(p.a)(v()(n),(function(e){return S(JSON.parse(e))}))||{});return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)("h3",{children:"Protected(swr)"}),r.isValidating&&Object(L.jsx)("div",{children:"validating..."}),Object(L.jsx)("ul",{children:null===(e=r.data)||void 0===e||null===(t=e.result)||void 0===t?void 0:t.map((function(e){return Object(L.jsx)("li",{children:e.name},e.name)}))})]})}function R(){var e=function(e){var t,n,r,c,i,a,o=null!==(t=e.limit)&&void 0!==t?t:100,l=Object(p.b)((function(t,n){var r,c;return n&&(null!==(r=null===(c=n.result)||void 0===c?void 0:c.length)&&void 0!==r?r:0)<o?null:v()(Object(u.a)(Object(u.a)({},e),{},{offset:t*o}))}),(function(e){return S(JSON.parse(e))})),j=null!==(n=null===(r=l.data)||void 0===r?void 0:r.map((function(e){var t;return null!==(t=e.result)&&void 0!==t?t:[]})))&&void 0!==n?n:[],d=(c=[]).concat.apply(c,Object(s.a)(j)),h=!!l.data&&(null!==(i=null===(a=l.data[l.data.length-1])||void 0===a?void 0:a.result)&&void 0!==i?i:[]).length<o;return Object(u.a)(Object(u.a)({},l),{},{fullListing:d,reachedEnd:h})}({systemId:"tapisv3-storage",path:"",limit:10}),t=e.size,n=e.setSize,r=e.fullListing,c=e.reachedEnd;return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)("h3",{children:"Infinite Scroll(swr)"}),Object(L.jsx)("ul",{children:r.map((function(e){return Object(L.jsx)("li",{children:e.name},e.name)}))}),Object(L.jsx)("button",{onClick:function(){return n(t+1)},children:c?"no more to fetch":"fetch next"})]})}function Y(){return Object(L.jsx)(d.a,{client:N,children:Object(L.jsx)(b.a,{children:Object(L.jsxs)("div",{children:[Object(L.jsx)(_,{}),Object(L.jsxs)("ul",{children:[Object(L.jsx)("li",{children:Object(L.jsx)(b.b,{to:"/public",children:"Public Page"})}),Object(L.jsx)("li",{children:Object(L.jsx)(b.b,{to:"/protected",children:"Protected Page (SWR)"})}),Object(L.jsx)("li",{children:Object(L.jsx)(b.b,{to:"/protectedinfiniteswr",children:"Protected Page(SWR infinite scroll)"})}),Object(L.jsx)("li",{children:Object(L.jsx)(b.b,{to:"/protectedquery",children:"Protected Page(react-query)"})}),Object(L.jsx)("li",{children:Object(L.jsx)(b.b,{to:"/protectedinfinitequery",children:"Protected Page(react-query infinite scroll)"})})]}),Object(L.jsxs)(h.d,{children:[Object(L.jsx)(h.b,{path:"/public",children:Object(L.jsx)(J,{})}),Object(L.jsx)(h.b,{path:"/login",children:Object(L.jsx)(D,{})}),Object(L.jsx)(A,{path:"/protected",children:Object(L.jsx)(B,{})}),Object(L.jsx)(A,{path:"/protectedinfiniteswr",children:Object(L.jsx)(R,{})}),Object(L.jsx)(A,{path:"/protectedquery",children:Object(L.jsx)(W,{})}),Object(L.jsx)(A,{path:"/protectedinfinitequery",children:Object(L.jsx)(z,{})})]})]})})})}var M=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,340)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),r(e),c(e),i(e),a(e)}))};a.a.render(Object(L.jsx)(c.a.StrictMode,{children:Object(L.jsx)(Y,{})}),document.getElementById("root")),M()},59:function(e,t,n){},60:function(e,t,n){}},[[334,1,2]]]);
//# sourceMappingURL=main.3e9f82f4.chunk.js.map